$.extend({getQueryParameters:function(t){return(t||document.location.search).replace(/(^\?)/,"").split("&").map(function(t){return t=t.split("="),this[t[0]]=t[1],this}.bind({}))[0]}});var getQuery=$.getQueryParameters();$.fn.textWidth=function(t,e){return $.fn.textWidth.fakeEl||($.fn.textWidth.fakeEl=$("<span>").hide().appendTo(document.body)),$.fn.textWidth.fakeEl.text(t||this.val()||this.text()).css("font",e||this.css("font")),$.fn.textWidth.fakeEl.width()},$(document).on("show.bs.modal",function(t){t.relatedTarget||$(".modal").not(t.target).modal("hide"),$(t.relatedTarget).parents(".modal").length>0&&$(t.relatedTarget).parents(".modal").modal("hide")}),$(document).on("shown.bs.modal",function(t){0==$("body").hasClass("modal-open")&&$("body").addClass("modal-open"),setTimeout(function(){0==$("body").hasClass("modal-open")&&$("body").addClass("modal-open")},200)}),$(document).on("hidden.bs.modal",function(t){$("body").css("padding-right","0")}),$(function(){function t(){console.log("unsetImagesSource");for(var t=$(".gallery-subcategory-item img"),e=0;e<t.length;++e)t.eq(e).attr("src",""),t.eq(e).data("src","img/default.svg").attr("src","img/default.svg")}function e(){var e=$(".gallery-subsection-triggers button.active").data("cat1"),a=$(".gallery-subsection__triggers button.active").data("cat2");console.log("updateGallery"),$.ajax({url:"db.php",data:{cat1:e,cat2:a},type:"POST",dataType:"json",success:function(e){console.log("success");var a=$(".gallery-subcategory-item img");t();for(var i=0;i<e.length;++i)a.eq(i).data("src",e[i].path).data("id",e[i].id),a.eq(i).parent().data("id",e[i].id),a.eq(i).parent().find(".gallery-subcategory-item-overlay-wrapper__title").text(e[i].title);r(e.length)},error:function(t){console.log("fail"),console.log(t)}})}function a(t,e){var a=Math.max.apply(null,$(t).map(function(){return $(this).outerHeight()}).get());$(e).height(a)}function i(){function t(t){return eMaxHeight=Math.max.apply(null,$(t).map(function(){return $(this).outerHeight()}).get())}var e=t(".options-slider-item__img"),a=t(".path-slider-item__img");$(".options-slider .slick-arrow").css("top",e/2),$(".path-slider .slick-arrow").css("top",a/2)}"success"==getQuery.order&&$("#order-success").modal("show"),"fail"==getQuery.order&&$("#order-fail").modal("show"),$(".payment-system").click(function(){$(".payment-form").submit(),window.location.reload()}),$(".gallery-subsection-triggers button").click(function(t){t.preventDefault(),$(".gallery-subsection-triggers button").removeClass("active"),$(this).addClass("active"),e()}),$(".gallery-subsection__triggers button").click(function(t){t.preventDefault(),$(".gallery-subsection__triggers button").removeClass("active"),$(this).addClass("active"),e()});var r=function(t){function e(){console.log("loadImg");var t=$(".gallery-subcategory-item img").eq(i.imgIndex),e=new Image;e.onload=a,e.src=t.data("src")}function a(){console.log("completeLoadImg");var t=$(".gallery-subcategory-item img").eq(i.imgIndex);t.attr("src",this.src),i.imgIndex++,i.imgIndex<i.imgLength&&setTimeout(e,i.delay)}var i={delay:100,imgIndex:0,imgLength:t};e()};e(),$(".path-slider, .events-slider").slick({arrows:!0,dots:!0,prevArrow:'<button class="arrow-left"><img src="img/arrow-left.png" alt=""></button>',nextArrow:'<button class="arrow-right"><img src="img/arrow-right.png" alt=""></button>',fade:!0}),$(".options-slider").slick({arrows:!0,dots:!1,prevArrow:'<button class="arrow-left"><img src="img/arrow-left.png" alt=""></button>',nextArrow:'<button class="arrow-right"><img src="img/arrow-right.png" alt=""></button>',fade:!0});var o,s=!1;$("#order-details").on("shown.bs.modal",function(t){function e(){$("input[name=ik_desc]").val(n.title),$("input[name=ik_am]").val(n.price+".00"),$("input[name=price]").val(n.price),$("input[name=title]").val(n.title)}function a(){if(s){$("#order-slider-for, #order-slider").slick("removeSlide",null,null,!0);for(image in o)$("#order-slider-for, #order-slider").slick("slickAdd",'<div><img src="'+o[image]+'" alt=""></div>')}else{$("#order-slider-for").slick({slidesToShow:3,slidesToScroll:1,arrows:!0,dots:!1,verticalSwiping:!0,draggable:!0,vertical:!0,prevArrow:'<button class="arrow-left"><img src="img/arrow-up.png" alt=""></button>',nextArrow:'<button class="arrow-right"><img src="img/arrow-down.png" alt=""></button>',asNavFor:"#order-slider",centerMode:!0,centerPadding:"0px",speed:300,responsive:[{breakpoint:600,settings:{vertical:!1,prevArrow:'<button class="arrow-left"><img src="img/arrow-left.png" alt=""></button>',nextArrow:'<button class="arrow-right"><img src="img/arrow-right.png" alt=""></button>',verticalSwiping:!1}}]}),$("#order-slider").slick({slidesToShow:1,slidesToScroll:1,asNavFor:"#order-slider-for",dots:!1,arrows:!1,swipe:!0,fade:!0});for(image in o)$("#order-slider-for, #order-slider").slick("slickAdd",'<div><img src="'+o[image]+'" alt=""></div>');s=!0}$(".order-modal-slider-wrapper").css("height",.75*$(".order-modal-slider-wrapper").width()),$("#order-slider-for").on("click",".slick-slide",function(t){t.stopPropagation();var e=$(this).data("slick-index");$(".slick-slider").slick("slickCurrentSlide")!==e&&($(".slick-slider").slick("slickGoTo",e),$("#order-slider-for .slick-slide").removeClass("slick-current"),$(this).addClass("slick-current"))})}$.ajax({url:"db.php",type:"POST",data:{id:$(t.relatedTarget).data("id")},dataType:"json",success:function(t){$("[data-ajax-title]").text(t[0].title),$("[data-ajax-description]").text(t[0].description),$("[data-ajax-price]").text("$"+t[0].price),n=t[0],o=JSON.parse(n.attachments),a(),e()}})}),$(".payment-form__select").selectize({options:['<option value="1">Способ доставки</option>','<option value="2">Почта <span class="select-price">$20</span></option>','<option value="3">Самовывоз <span class="select-price">$30</span></option>','<option value="4">Курьер <span class="select-price">$10</span></option>'],options:[{name:"Способ доставки",price:0,value:1},{name:"Почта",price:20,value:2},{name:"Самовывоз",price:30,value:3},{name:"Курьер",price:10,value:4}],render:{item:function(t,e){return'<div data-value="'+t.value+'">'+(t.name?'<span class="select-name">'+e(t.name)+"</span>":"")+(t.price?'<span class="select-price">$'+e(t.price)+"</span>":"")+"</div>"},option:function(t,e){return'<div class="option" data-delivery-price="'+e(t.price)+'" data-value="'+t.value+'">'+(t.name?'<span class="select-name">'+e(t.name)+"</span>":"")+(t.price?'<span class="select-price">$'+e(t.price)+"</span>":"")+"</div>"}},onDropdownClose:function(t){var e=$("[data-delivery-price].selected").attr("data-delivery-price");$("[data-ajax-price]").text("$"+Number(n.price+e)),$("input[name=ik_am]").val(n.price+e+".00"),$("input[name=price]").val(n.price+e)}}),$(".order-modal-payment-options__select").selectize({});var n;$(window).load(function(){a(".decoration",".decorations-wrapper"),a(".review",".reviews-wrapper"),i()}),$("[data-subsection-trigger], [data-option-trigger]").each(function(){width=$(this).width(),$(this).css("width",width+20+"px")}),$(".flipster").flipster({itemContainer:".reviews-slider",itemSelector:".reviews-slider-item",spacing:-.88,buttons:"custom",buttonPrev:'<img src="img/arrow-left.png">',buttonNext:'<img src="img/arrow-right.png">',scrollwheel:!1,onItemSwitch:function(t,e){$(".review").removeClass("active"),$(".review[data-review="+t.getAttribute("data-review")+"]").addClass("active")}}),$("[data-option-trigger]").click(function(){$("[data-option-trigger]").removeClass("active"),$(this).addClass("active"),$(".options-slider").slick("slickGoTo",$(this).attr("data-option-trigger")-1)}),$(".options-slider").on("beforeChange",function(t,e,a,i){$("[data-option-trigger]").removeClass("active"),$("[data-option-trigger="+(i+1)+"]").addClass("active")}),$("[data-decoration-trigger]").click(function(){$("[data-decoration-trigger]").removeClass("active"),$(this).addClass("active"),$("[data-decoration]").removeClass("active"),$("[data-decoration="+$(this).attr("data-decoration-trigger")+"]").addClass("active")}),$(".scroll-down").click(function(){$("html, body").animate({scrollTop:$("section.top-screen + section").offset().top},700)}),$("input[name=name]").on("input",function(){0!=$("input[name=name]").val().length?$(".letter-form .name").text($(this).val()):$(".letter-form .name").html("&nbsp;")}),$(".letter-form").on("input","input[data-input=additional]",function(){var t=$("input[data-input=additional]").last();t.outerWidth()<=t.textWidth()&&(t.after('<input type="text" data-input="additional" name="additional[]" data-count="">'),t=$("input[data-input=additional]").last().focus()),$(this).outerWidth()<=$(this).textWidth()&&$(this).next().focus()}),$(".letter-form__submit").click(function(t){t.preventDefault(),$.post("mail.php",$(this).parents("form").serialize(),function(t){t?$("#letter-success").modal("show"):$("#letter-fail").modal("show")})});var l=1754/232;$(".no-backgroundcliptext h2.clipped").css("height",$(".no-backgroundcliptext h2.clipped").width()/l),$(window).resize(function(){i(),a(".decoration",".decorations-wrapper"),a(".review",".reviews-wrapper"),$(".no-backgroundcliptext h2.clipped").css("height",$(".no-backgroundcliptext h2.clipped").width()/l),$(".order-modal-slider-wrapper").css("height",.75*$(".order-modal-slider-wrapper").width())}),$(".modal").click(function(t){$(t.target).hasClass("modal-dialog")||$(t.target).parents(".modal-dialog").length||$(".modal").modal("hide")})});